<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>환영합니다!</title>
	<link rel="stylesheet" href="css/main.css">
</head>
<body>
    <th:block th:include="common/header"></th:block>

	<div class="container">
	    <main>
	        <div class="slider" id="slider"></div>
	    </main>
	    <div class="dots-container">
	        <div class="dots" id="dots"></div>
	    </div>

	    <div class="main-page">
	        <br>
	        <hr>
			<div class="title-row">
			    <h2>최근 보호중인 아이들</h2>
			    <a href="/mainAllpage/allpage">전체보기</a>
			</div>
			<div class="all-card">
			    <div th:each="ap : ${list}">
			        <div class="card-container">
			            <a th:href="@{/mainAllpage/detail(protectNo=${ap.protectNo})}">
			                <div class="card">
			                    <img th:src="${ap.thumbnailUrl}" alt="이미지" />
			                </div>
			            </a>
			            <div class="card-info">
			                <h3 th:text="${ap.protectTitle}">제목</h3>
			                <span class="like">좋아요</span>
			            </div>
			            <p class="date" th:text="${ap.protectDate}">2025-xx-xx</p>
			        </div>
			    </div>
			</div>

	        <div class="more-btn-container">
	            <button class="more-btn">더보기</button>
	        </div>
	    </div>
	</div>
	<script src="js/main.js"></script>
	<script>
	{
	    let startIndex = 4; 
	    const count = 8;
	    const cardContainer = document.querySelector(".all-card");
	    const moreBtn = document.querySelector(".more-btn");

	    moreBtn.addEventListener("click", () => {
	        fetch(`/mainAllpage/loadMore?start=${startIndex + 1}&count=${count}`)
	            .then(res => res.json())
	            .then(data => {
	                data.forEach(ap => {
	                    const div = document.createElement("div");
	                    div.className = "card-container";
	                    div.innerHTML = `
	                        <a href="/mainAllpage/detail?protectNo=${ap.protectNo}">
	                            <div class="card">
	                                <img class="thumbnail" src="${ap.thumbnailUrl}" alt="썸네일" />
	                            </div>
	                        </a>
	                        <div class="card-info">
	                            <h3>${ap.protectTitle}</h3>
	                            <span class="like">좋아요</span>
	                        </div>
	                        <p class="date">${ap.protectDate}</p>
	                    ;
	                    cardContainer.appendChild(div);
	                });
	                moreBtn.style.display = "none";
	            });
	    });
	}
	</script>
	
    <th:block th:include="common/footer"></th:block>
</body>
</html>